(()=>{"use strict";const e=window.React,i=window.wp.htmlEntities,n=window.wp.element;const t=["billing_address","billing_city","billing_country","billing_postal","customer_first_name","customer_last_name","customer_phone","customer_zip","customer_address","customer_city","customer_country","customer_email"],a=function(e){const i={};return Object.keys(e).forEach((n=>{let a;a=t.includes(n)?"BillingInfo["+n+"]":n,"billing_country"===n?i["BillingInfo[country]"]=e[n]:i[a]=e[n]})),i},l=()=>({back:(0,n.useCallback)((()=>{const e=[];e.push({name:"action",value:"ecommpay_break"}),window.ECP.order_id>0&&e.push({name:"order_id",value:window.ECP.order_id}),window.jQuery.ajax({type:"POST",url:window.ECP.ajax_url+"?"+window.location.href.split("?")[1],data:e,dataType:"json",success:function(e){console.log(e)},error:function(e,i,n){console.error(e,i,n)}})}),[])}),s=function(e){const[i,t]=(0,n.useState)(e);return{value:i,setTrue:(0,n.useCallback)((()=>{t(!0)}),[]),setFalse:(0,n.useCallback)((()=>{t(!1)}),[]),toggle:(0,n.useCallback)((()=>{t((e=>!e))}),[])}},r=function(i){const{darkMode:n}=i;return(0,e.createElement)("img",{style:{display:"block"},src:n?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBzdHlsZT0ibWFyZ2luOiBhdXRvOyBkaXNwbGF5OiBibG9jazsgc2hhcGUtcmVuZGVyaW5nOiBhdXRvOyIgd2lkdGg9IjM0cHgiIGhlaWdodD0iMzRweCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4KPGcgdHJhbnNmb3JtPSJyb3RhdGUoMCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiNmZmYiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC44NzVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDQ1IDUwIDUwKSI+CiAgPHJlY3QgeD0iNDguNSIgeT0iNiIgcng9IjAiIHJ5PSIwIiB3aWR0aD0iNiIgaGVpZ2h0PSIyNSIgZmlsbD0iI2ZmZiI+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjE7MCIga2V5VGltZXM9IjA7MSIgZHVyPSIxcyIgYmVnaW49Ii0wLjc1cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSg5MCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiNmZmYiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC42MjVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDEzNSA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiNmZmYiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC41cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSgxODAgNTAgNTApIj4KICA8cmVjdCB4PSI0OC41IiB5PSI2IiByeD0iMCIgcnk9IjAiIHdpZHRoPSI2IiBoZWlnaHQ9IjI1IiBmaWxsPSIjZmZmIj4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMTswIiBrZXlUaW1lcz0iMDsxIiBkdXI9IjFzIiBiZWdpbj0iLTAuMzc1cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSgyMjUgNTAgNTApIj4KICA8cmVjdCB4PSI0OC41IiB5PSI2IiByeD0iMCIgcnk9IjAiIHdpZHRoPSI2IiBoZWlnaHQ9IjI1IiBmaWxsPSIjZmZmIj4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMTswIiBrZXlUaW1lcz0iMDsxIiBkdXI9IjFzIiBiZWdpbj0iLTAuMjVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDI3MCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiNmZmYiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC4xMjVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDMxNSA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiNmZmYiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSIwcyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz4KPCEtLSBbbGRpb10gZ2VuZXJhdGVkIGJ5IGh0dHBzOi8vbG9hZGluZy5pby8gLS0+PC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBzdHlsZT0ibWFyZ2luOiBhdXRvOyBkaXNwbGF5OiBibG9jazsgc2hhcGUtcmVuZGVyaW5nOiBhdXRvOyIgd2lkdGg9IjM0cHgiIGhlaWdodD0iMzRweCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIj4KPGcgdHJhbnNmb3JtPSJyb3RhdGUoMCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiMwMDU3OWUiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC44NzVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDQ1IDUwIDUwKSI+CiAgPHJlY3QgeD0iNDguNSIgeT0iNiIgcng9IjAiIHJ5PSIwIiB3aWR0aD0iNiIgaGVpZ2h0PSIyNSIgZmlsbD0iIzAwNTc5ZSI+CiAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJvcGFjaXR5IiB2YWx1ZXM9IjE7MCIga2V5VGltZXM9IjA7MSIgZHVyPSIxcyIgYmVnaW49Ii0wLjc1cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSg5MCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiMwMDU3OWUiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC42MjVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDEzNSA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiMwMDU3OWUiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC41cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSgxODAgNTAgNTApIj4KICA8cmVjdCB4PSI0OC41IiB5PSI2IiByeD0iMCIgcnk9IjAiIHdpZHRoPSI2IiBoZWlnaHQ9IjI1IiBmaWxsPSIjMDA1NzllIj4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMTswIiBrZXlUaW1lcz0iMDsxIiBkdXI9IjFzIiBiZWdpbj0iLTAuMzc1cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz48ZyB0cmFuc2Zvcm09InJvdGF0ZSgyMjUgNTAgNTApIj4KICA8cmVjdCB4PSI0OC41IiB5PSI2IiByeD0iMCIgcnk9IjAiIHdpZHRoPSI2IiBoZWlnaHQ9IjI1IiBmaWxsPSIjMDA1NzllIj4KICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9Im9wYWNpdHkiIHZhbHVlcz0iMTswIiBrZXlUaW1lcz0iMDsxIiBkdXI9IjFzIiBiZWdpbj0iLTAuMjVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDI3MCA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiMwMDU3OWUiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSItMC4xMjVzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSI+PC9hbmltYXRlPgogIDwvcmVjdD4KPC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKDMxNSA1MCA1MCkiPgogIDxyZWN0IHg9IjQ4LjUiIHk9IjYiIHJ4PSIwIiByeT0iMCIgd2lkdGg9IjYiIGhlaWdodD0iMjUiIGZpbGw9IiMwMDU3OWUiPgogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0ib3BhY2l0eSIgdmFsdWVzPSIxOzAiIGtleVRpbWVzPSIwOzEiIGR1cj0iMXMiIGJlZ2luPSIwcyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiPjwvYW5pbWF0ZT4KICA8L3JlY3Q+CjwvZz4KPCEtLSBbbGRpb10gZ2VuZXJhdGVkIGJ5IGh0dHBzOi8vbG9hZGluZy5pby8gLS0+PC9zdmc+",alt:"Loading...",width:34,height:34})},d=function(i){const{show:t}=i,a=function(e,i){const[t,a]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{let n;return e&&!t?a(!0):!e&&t&&(n=setTimeout((()=>a(!1)),i)),()=>clearTimeout(n)}),[e,i,t]),t}(t,300),l=(0,n.useMemo)((()=>{var e;return null!==(e=window.ECP.darkMode)&&void 0!==e?e:window.matchMedia("(prefers-color-scheme: dark)").matches}),[]);return(0,n.useEffect)((()=>(document.body.style.overflow=t?"hidden":"auto",()=>{document.body.style.overflow="auto"})),[t]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("style",null,"\n          @keyframes fade-in {\n            from {\n              opacity: 0;\n            }\n            to {\n              opacity: 1;\n            }\n          }\n        "),a&&(0,e.createElement)("div",{id:"ecommpay-loader-embedded",style:{display:"flex",position:"fixed",top:0,left:0,width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"10px",backgroundColor:l?"rgba(0, 0, 0, 0.9)":"rgba(255, 255, 255, 0.9)",opacity:t?1:0,animation:"fade-in 300ms",transition:"opacity 500ms",zIndex:9999}},(0,e.createElement)(r,{darkMode:l})))},o=function(i){const{value:t,setTrue:r,setFalse:o}=s(!1),{value:c,setTrue:I}=s(!1),{value:m,setFalse:g}=s(!0),{back:u}=l(),p=(0,n.useCallback)((e=>{const i=document.createElement("form");i.setAttribute("method",e.method),i.setAttribute("action",e.url),i.setAttribute("style","display:none;"),i.setAttribute("name","3dsForm");for(let n in e.body){const t=document.createElement("input");t.name=n,t.value=e.body[n],i.appendChild(t)}document.body.appendChild(i),i.submit()}),[]),b=(0,n.useCallback)((e=>{if(e.origin!==window.ECP.origin_url)return;const i=JSON.parse(e.data);switch(i.message){case"epframe.show_clarification_page":return window.ECP.listeners.onShowClarificationPage();case"epframe.embedded_mode.check_validation_response":return window.ECP.listeners.onEmbeddedModeCheckValidationResponse(i);case"epframe.payment.success":case"epframe.card.verify.success":return window.ECP.listeners.onSuccess();case"epframe.payment.fail":case"epframe.card.verify.fail":return window.ECP.listeners.onFail()}}),[]),y=(0,n.useCallback)((e=>new Promise((n=>{window.ECP.listeners={onShowClarificationPage:()=>{I(),o(),n({type:i.emitResponse.responseTypes.ERROR,messageContext:i.emitResponse.noticeContexts.PAYMENTS,message:"Clarification required"})},onEmbeddedModeCheckValidationResponse:t=>{if(l='[for="radio-control-wc-payment-method-options-ecommpay-card"]',document.querySelector(l)?.scrollIntoView({behavior:"smooth"}),0===Object.keys(t.data).length)window.postMessage(JSON.stringify({message:"epframe.embedded_mode.submit",fields:a(e),from_another_domain:!0}));else{const e=Array.from(new Set(Object.values(t.data)));n({type:i.emitResponse.responseTypes.ERROR,messageContext:i.emitResponse.noticeContexts.PAYMENTS,message:"<b>Validation failed:</b> <ul><li>"+e.join("</li><li>")+"</li></ul>",retry:!0})}var l},onSuccess:()=>{o(),n({type:i.emitResponse.responseTypes.SUCCESS,redirectUrl:e.redirect_success_url})},onFail:()=>{o(),n({type:i.emitResponse.responseTypes.FAIL,messageContext:i.emitResponse.noticeContexts.PAYMENTS,message:"Payment failed"})}},setTimeout((()=>{window.postMessage(JSON.stringify({message:"epframe.embedded_mode.check_validation",from_another_domain:!0}))}),2e3)}))),[]),w=function(i,n,t){var a=this,l=(0,e.useRef)(null),s=(0,e.useRef)(0),r=(0,e.useRef)(null),d=(0,e.useRef)([]),o=(0,e.useRef)(),c=(0,e.useRef)(),I=(0,e.useRef)(i),m=(0,e.useRef)(!0);I.current=i;var g="undefined"!=typeof window,u=!n&&0!==n&&g;if("function"!=typeof i)throw new TypeError("Expected a function");n=+n||0;var p=!!(t=t||{}).leading,b=!("trailing"in t)||!!t.trailing,y="maxWait"in t,w="debounceOnServer"in t&&!!t.debounceOnServer,P=y?Math.max(+t.maxWait||0,n):null;(0,e.useEffect)((function(){return m.current=!0,function(){m.current=!1}}),[]);var Z=(0,e.useMemo)((function(){var e=function(e){var i=d.current,n=o.current;return d.current=o.current=null,s.current=e,c.current=I.current.apply(n,i)},i=function(e,i){u&&cancelAnimationFrame(r.current),r.current=u?requestAnimationFrame(e):setTimeout(e,i)},t=function(e){if(!m.current)return!1;var i=e-l.current;return!l.current||i>=n||i<0||y&&e-s.current>=P},Z=function(i){return r.current=null,b&&d.current?e(i):(d.current=o.current=null,c.current)},C=function e(){var a=Date.now();if(t(a))return Z(a);if(m.current){var r=n-(a-l.current),d=y?Math.min(r,P-(a-s.current)):r;i(e,d)}},h=function(){if(g||w){var I=Date.now(),u=t(I);if(d.current=[].slice.call(arguments),o.current=a,l.current=I,u){if(!r.current&&m.current)return s.current=l.current,i(C,n),p?e(l.current):c.current;if(y)return i(C,n),e(l.current)}return r.current||i(C,n),c.current}};return h.cancel=function(){r.current&&(u?cancelAnimationFrame(r.current):clearTimeout(r.current)),s.current=0,d.current=l.current=o.current=r.current=null},h.isPending=function(){return!!r.current},h.flush=function(){return r.current?Z(Date.now()):c.current},h}),[p,y,n,P,b,u,g,w]);return Z}((()=>{const e=[{name:"action",value:"get_data_for_payment_form"}];window.ECP.order_id>0&&e.push({name:"order_id",value:window.ECP.order_id}),window.jQuery.ajax({type:"POST",url:window.ECP.ajax_url+"?"+window.location.href.split("?")[1],data:e,dataType:"json",success:function(e){window.ECP={...window.ECP,isEmbeddedMode:!0,paramsForEmbeddedPP:{...e,onExit:u,onDestroy:u,onLoaded:g,onEnterKeyPressed:i.onSubmit,onPaymentSent:r,onSubmitClarificationForm:r,onEmbeddedModeRedirect3dsParentPage:p}},window.EPayWidget.run(window.ECP.paramsForEmbeddedPP,"POST")},error:function(e,i,n){console.error(e,i,n)}})}),2e3);return(0,n.useEffect)((()=>{const e=i.eventRegistration.onPaymentSetup((async()=>{if(!c)return{type:i.emitResponse.responseTypes.SUCCESS,meta:{paymentMethodData:{payment_id:window.ECP.paramsForEmbeddedPP.payment_id}}};window.postMessage(JSON.stringify({message:"epframe.embedded_mode.submit",fields:{},from_another_domain:!0}))}),0),n=i.eventRegistration.onCheckoutSuccess((async e=>{window.ECP.order_id=e.orderId;const n=JSON.parse(e.processingResponse.paymentDetails.optionsJson),t=n.payment_amount,a=i.billing.currency.minorUnit-(["BIF","CLP","DJF","GNF","ISK","JPY","KMF","KRW","PYG","RWF","UGX","UYI","VND","VUV","XAF","XOF","XPF"].includes(i.billing.currency.code)?0:2),l=t===Math.round(i.billing.cartTotal.value/Math.pow(10,a)),s=i.billing.currency.code===n.payment_currency;return l&&s?await y(n):{type:i.emitResponse.responseTypes.ERROR,messageContext:i.emitResponse.noticeContexts.CHECKOUT,message:"Cart amount has changed, please refresh the page and try again"}}),0);return()=>{e(),n()}}),[i.eventRegistration.onCheckoutSuccess]),(0,n.useEffect)((()=>{w()}),[i.billing.appliedCoupons,i.billing.billingAddress.address_1,i.billing.billingAddress.address_2,i.billing.billingAddress.city,i.billing.billingAddress.company,i.billing.billingAddress.country,i.billing.billingAddress.email,i.billing.billingAddress.first_name,i.billing.billingAddress.last_name,i.billing.billingAddress.phone,i.billing.billingAddress.postcode,i.billing.billingAddress.state,i.billing.billingData.address_1,i.billing.billingData.address_2,i.billing.billingData.city,i.billing.billingData.company,i.billing.billingData.country,i.billing.billingData.email,i.billing.billingData.first_name,i.billing.billingData.last_name,i.billing.billingData.phone,i.billing.billingData.postcode,i.billing.billingData.state,i.billing.cartTotal.label,i.billing.cartTotal.value,i.billing.cartTotalItems,i.billing.currency.code,i.billing.currency.decimalSeparator,i.billing.currency.minorUnit,i.billing.currency.prefix,i.billing.currency.suffix,i.billing.currency.symbol,i.billing.currency.thousandSeparator,i.billing.customerId,i.billing.displayPricesIncludingTax,i.shippingData.isSelectingRate,i.shippingData.needsShipping,i.shippingData.selectedRates,i.shippingData.shippingAddress.address_1,i.shippingData.shippingAddress.address_2,i.shippingData.shippingAddress.city,i.shippingData.shippingAddress.company,i.shippingData.shippingAddress.country,i.shippingData.shippingAddress.first_name,i.shippingData.shippingAddress.last_name,i.shippingData.shippingAddress.phone,i.shippingData.shippingAddress.postcode,i.shippingData.shippingAddress.state,i.shippingData.shippingRates,i.shippingData.shippingRatesLoading,i.cartData.cartFees,i.cartData.cartItems,i.cartData.extensions,i.shouldSavePayment]),(0,n.useEffect)((()=>(window.ECP.listeners={},window.addEventListener("message",b),()=>{window.removeEventListener("message",b),window.ECP.listeners={}})),[b]),(0,e.createElement)(e.Fragment,null,m&&"Loading...",(0,e.createElement)("div",{id:"ecommpay-iframe-embedded",style:{height:m?"0":"auto"}}),(0,e.createElement)(d,{show:t}))},c=function(e){const{back:i}=l(),t=(0,n.useCallback)((n=>new Promise((t=>{window.EPayWidget.run({...n,onPaymentSuccess:()=>{t({type:e.emitResponse.responseTypes.SUCCESS,redirectUrl:""})},onPaymentFail:()=>{t({type:e.emitResponse.responseTypes.ERROR,messageContext:e.emitResponse.noticeContexts.PAYMENTS,message:"Payment failed",retry:!0})},onExit:()=>{i(),t({type:e.emitResponse.responseTypes.ERROR,messageContext:e.emitResponse.noticeContexts.CHECKOUT_ACTIONS,message:"Payment cancelled",retry:!0})},onDestroy:()=>{i(),t({type:e.emitResponse.responseTypes.ERROR,messageContext:e.emitResponse.noticeContexts.CHECKOUT_ACTIONS,message:"Payment cancelled",retry:!0})}},"POST")}))),[i]);return(0,n.useEffect)((()=>{const i=e.eventRegistration.onCheckoutSuccess((async e=>{window.ECP.order_id=e.orderId;const i=JSON.parse(e.processingResponse.paymentDetails.optionsJson);return await t(i)}),0);return()=>{i()}}),[e.eventRegistration.onCheckoutSuccess,t]),e.children},I=function(t){const a=(0,n.useMemo)((()=>(0,i.decodeEntities)(t.data.description)),[t.data.description]);return(0,n.useMemo)((()=>"embedded"===t.data.pp_mode&&"ecommpay-card"===t.activePaymentMethod?(0,e.createElement)(o,{...t}):"popup"===t.data.pp_mode?(0,e.createElement)(c,{...t},a):a),[t])},m=function(n){return(0,e.createElement)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"10px"}},(0,i.decodeEntities)(n.data.title),n.data.icon&&(0,e.createElement)("img",{src:n.data.icon,alt:""}))},{getSetting:g}=window.wc.wcSettings,{registerPaymentMethod:u}=window.wc.wcBlocksRegistry,p=n=>{const t=g(`${n}_data`,null);if(!t)return;const a={name:n,label:(0,e.createElement)(m,{data:t}),content:(0,e.createElement)(I,{data:t}),edit:(0,e.createElement)(I,{data:t}),canMakePayment:()=>"ecommpay-apple-pay"!==n||Object.prototype.hasOwnProperty.call(window,"ApplePaySession")&&ApplePaySession.canMakePayments(),placeOrderButtonLabel:t.checkout_button_text,ariaLabel:(0,i.decodeEntities)(t.title),supports:{showSavedCards:!1,showSaveOption:!1,features:t.supports}};u(a)};for(const e of window.ECP.gateways)p(e)})();